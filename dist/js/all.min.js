function Fcm(){}!function(){function e(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null}function t(){"none"==$("#camera").css("display")?($("#camera").show(),$("#fileUpload").hide()):($("#camera").hide(),$("#fileUpload").show())}var a,o=!1;if(e()){var i={video:!0,audio:!1},n=document.getElementById("v");navigator.getUserMedia(i,function(e){var t=window.URL||window.webkitURL;n.src=t?t.createObjectURL(e):e,n.play(),o=!0,a=e},function(e){console.log("ERROR"),console.log(e)});document.getElementById("take").addEventListener("click",function(){if(o){var e=document.getElementById("canvas");e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0);var t=e.toDataURL("image/webp");document.getElementById("photo").setAttribute("src",t)}},!1),document.getElementById("nav-links").addEventListener("click",t)}else alert("KO");$("#upload").click(function(){var e=document.getElementById("canvas"),t=e.toDataURL("image/png"),a=t.replace(/^data:image\/(png|jpg);base64,/,"");$.ajax({url:"http://52.10.196.93:3000/upload",dataType:"json",data:{image:a},type:"POST",success:function(e){console.log("D: "+e)}})})}();var videoPlaying=!1,webCamStream,video=document.getElementById("v");Fcm.prototype.sendPhoto=function(){if(videoPlaying){var e=document.getElementById("canvas");e.width=video.videoWidth,e.height=video.videoHeight,e.getContext("2d").drawImage(video,0,0);var t=e.toDataURL("image/webp"),a=document.getElementById("myModal");a.style.display="none",webCamStream.stop(),this.upload(t)}},Fcm.prototype.initializeCamera=function(){if(videoPlaying=!1,this.isUserMedia()){var e={video:!0,audio:!1};navigator.getUserMedia(e,function(e){var t=window.URL||window.webkitURL;video.src=t?t.createObjectURL(e):e,video.play(),videoPlaying=!0,webCamStream=e},function(e){console.log("ERROR"),console.log(e)});document.getElementsByClassName("close")[0].addEventListener("click",function(){var e=document.getElementById("myModal");e.style.display="none",webCamStream.stop(),videoPlaying=!1})}else alert("KO")},Fcm.prototype.isUserMedia=function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null},Fcm.prototype.usePhoto=function(){var e=$(".ScrollArea .selected").attr("id"),t=document.getElementById(e),a=document.createElement("canvas");a.width=t.width,a.height=t.height;var o=a.getContext("2d");o.drawImage(t,0,0);var i=a.toDataURL();this.upload(i)},Fcm.prototype.selPhoto=function(e){var t=this;if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(e){var a=document.createElement("img");a.setAttribute("src",e.target.result);var o=document.createElement("canvas");o.width=a.width,o.height=a.height;var i=o.getContext("2d");i.drawImage(a,0,0);var n=o.toDataURL();t.upload(n)},a.readAsDataURL(e.files[0])}},Fcm.prototype.openModal=function(){var e=document.getElementById("myModal");e.style.display="block",this.initializeCamera()},Fcm.prototype.upload=function(e){var t=e.replace(/^data:image\/(png|jpg);base64,/,"");$("#results").show(),$("#analyzingLabel").show(),$("#selectImage").hide(),$.ajax({url:"http://52.10.196.93:3000/upload",data:{image:t},type:"POST",success:function(e){$("#analyzingLabel").hide(),$("#thumbContainer").show()}})},Fcm.prototype.tryAnother=function(){$("#results").hide(),$("#selectImage").show()};var fcm=new Fcm;